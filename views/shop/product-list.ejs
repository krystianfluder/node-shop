<%- include('../includes/head.ejs') %>
</head>

<body>
  <%- include('../includes/navigation.ejs') %>
  <main class="container">
    <%- include('../includes/breadcrumbs-and-header.ejs') %>
    
    <% if (prods.length > 0) { %>

    <div class="d-flex flex-wrap">
      <% for (let product of prods) { %>
        <div class="card" style="width: 200px;">
          <img class="card-image-top" src="/<%= product.imageUrlSmall %>" alt="<%= product.title %>">
          <ul class="list-group list-group-flush">
            <li class="list-group-item d-flex flex-column">
              <a href="/products/<%=product._id %>" class="btn btn-link">
                <strong>
                  <% if (product.title.length >= 10) { product.title = product.title.substring(0, 10)+'...' } %>
                  <%= product.title %>
                </strong>
              </a>
            </li>
            <li class="list-group-item">
              <%= product.price/100 %> <%= process.env.CURRENCY %>
            </li>
            <% if (isAuthenticated) { %>
              <li class="list-group-item">
                <%- include('../includes/add-to-cart.ejs', {product, quantity: 1, message: "Add to Cart"}) %>
              </li>
            <% } %>

          </ul>
        </div>
      <% } %>
    </div>

    <% } else { %>
    <h1>No Products Found!</h1>
    <% } %>
    
  </main>
  <%- include('../includes/end.ejs') %>
  <%- include('../includes/add-to-cart-script.ejs') %>